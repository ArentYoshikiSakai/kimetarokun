# 食事提案Webアプリケーション仕様書

## 1. プロジェクト概要

### 1.1 アプリケーション名
「FoodMood - 食べたいもの発見アプリ」

### 1.2 目的
- ユーザーが食べたいものを言語化できない時に、対話形式で欲求を明確化する
- ユーザーの気分や状況に合わせた食事提案を行う

### 1.3 ターゲットユーザー
- 「お腹は空いているが何を食べたいか分からない」と悩む人
- 食事選びに時間をかけたくない人

## 2. 機能要件

### 2.1 コア機能
1. **対話式食欲探索機能**
   - 選択式の質問を通じてユーザーの食欲を探索
   - 質問は状況、気分、食感、味の好みなどに関するもの
   - 各質問は2〜5つの選択肢から選ぶ形式

2. **食事提案機能**
   - 対話の結果をもとにGPT APIを使用して適切な食事を提案
   - 提案には料理名、簡単な説明、主な特徴を含む
   - 複数の選択肢（3〜5件）を提示

3. **履歴機能**
   - 過去の提案結果を閲覧できる機能
   - ローカルストレージを使用して保存

## 3. 画面設計

### 3.1 画面構成
1. **ホーム画面**
   - アプリ名とシンプルな説明
   - 「始める」ボタン
   - 履歴へのアクセスリンク

2. **質問画面**
   - 質問文と選択肢ボタン
   - 進行状況インジケーター
   - 「戻る」ボタン

3. **結果画面**
   - 提案された食事のリスト
   - 各提案の詳細情報
   - 「もう一度探す」ボタン
   - 「履歴に保存」ボタン

4. **履歴画面**
   - 過去の提案履歴リスト
   - 各項目をタップで詳細表示

### 3.2 UI/UXガイドライン
- モバイルファーストのレスポンシブデザイン
- シンプルで直感的なインターフェース
- 最小限の視覚要素
- 操作ステップを明確に表示

## 4. システム構成

### 4.1 技術スタック
- **フロントエンド**: React.js、TypeScript
- **状態管理**: React Context API
- **スタイリング**: Tailwind CSS または Styled Components
- **外部API**: OpenAI GPT API
- **ビルドツール**: Vite

### 4.2 ディレクトリ構成
```
src/
├── components/
│   ├── Home/
│   ├── Questions/
│   ├── Results/
│   ├── History/
│   └── common/
├── contexts/
│   └── AppContext.tsx
├── hooks/
│   └── useQuestionFlow.ts
├── services/
│   └── gptService.ts
├── types/
│   └── index.ts
├── utils/
│   └── storage.ts
├── App.tsx
└── main.tsx
```

## 5. データモデル

### 5.1 質問データ構造
```typescript
interface Question {
  id: string;
  text: string;
  options: {
    id: string;
    text: string;
  }[];
  nextQuestionId?: string | Record<string, string>;
}
```

### 5.2 ユーザー回答データ構造
```typescript
interface UserAnswer {
  questionId: string;
  selectedOptionId: string;
  selectedOptionText: string;
}

interface UserSession {
  id: string;
  timestamp: number;
  answers: UserAnswer[];
}
```

### 5.3 提案データ構造
```typescript
interface FoodSuggestion {
  id: string;
  name: string;
  description: string;
  characteristics: string[];
  sessionId: string;
  timestamp: number;
}
```

## 6. 質問フロー設計

### 6.1 基本質問セット
1. **栄養成分**
   - 質問: 「今どんな栄養を取りたい気分ですか？」
   - 選択肢: 「タンパク質」「炭水化物」「脂質」「食物繊維」

2. **味の濃さ**
   - 質問: 「味の濃さはどの程度がいいですか？」
   - 選択肢: 「濃い」「薄い」「普通」

3. **ジューシーさ**
   - 質問: 「ジューシーかたんぱくどちらのものを食べたいですか？」
   - 選択肢: 「脂質多め」「たんぱく」

4. **量**
   - 質問: 「どれくらいの量を食べたいですか？」
   - 選択肢: 「多め」「普通」「少な目」

5. **汁っけ**
   - 質問: 「汁っけは欲しいですか？」
   - 選択肢: 「欲しい」「欲しくない」「どちらでもない」

6. **即時性**
   - 質問: 「すぐ食べれるものがですか？」
   - 選択肢: 「はい」「いいえ」「どちらでもない」

7. **熱通し**
   - 質問: 「熱を通しているものがいいですか？」
   - 選択肢: 「はい」「いいえ」「どちらでもない」

8. **予算感**
   - 質問: 「予算はどのくらいですか？」
   - 選択肢: 「リーズナブル」「ふつう」「ちょっと贅沢」
   
9. **温度感**
   - 質問: 「温かいものと冷たいもの、どちらが食べたいですか？」
   - 選択肢: 「温かいもの」「冷たいもの」「どちらでも」

10. **食感**
   - 質問: 「どんな食感が食べたいですか？」
   - 選択肢: 「柔らかいもの」「歯ごたえのあるもの」「さくさく/カリカリしたもの」「とろみのあるもの」

11. **味の種類**
   - 質問: 「どんな味が好みですか？」
   - 選択肢: 「塩味/しょっぱいもの」「甘いもの」「辛いもの」「酸っぱいもの」「うま味の強いもの」

12. **ジャンル**
   - 質問: 「何系の料理が食べたいですか？」
   - 選択肢: 「和食」「洋食」「中華」「エスニック」「どれでも」

13. **満足度**
   - 質問: 「どのくらいお腹を満たしたいですか？」
   - 選択肢: 「軽く食べたい」「しっかり食べたい」「がっつり食べたい」

## 7. API設計

### 7.1 GPT API連携
```typescript
// GPT APIリクエスト関数
const generateFoodSuggestions = async (userAnswers: UserAnswer[]): Promise<FoodSuggestion[]> => {
  // OpenAI GPT APIへのリクエスト処理
  // ユーザー回答からプロンプトを構築
  // レスポンスをパースして提案データに変換
};
```

### 7.2 プロンプト設計例
```
あなたは食事提案アシスタントです。以下のユーザーの好みに基づいて、3つの食事を提案してください。

ユーザーの回答:
- 状況: {状況の回答}
- 食事の種類: {食事種類の回答}
- 温度感: {温度感の回答}
- 食感: {食感の回答}
- 味の種類: {味の回答}
- 料理のジャンル: {ジャンルの回答}
- 満足度: {満足度の回答}

各提案には以下を含めてください:
1. 料理名
2. 簡単な説明（なぜこの料理がユーザーの好みに合うか）
3. 主な特徴（5つ以内のキーワード）

JSON形式で回答してください。
```

## 8. 実装計画

### 8.1 フェーズ1: MVP開発
- 基本的な質問フロー実装
- GPT API連携
- 最小限のUI実装

### 8.2 フェーズ2: 機能拡張
- 履歴機能の追加
- UI/UXの改善
- エラーハンドリングの強化

### 8.3 フェーズ3（将来拡張）
- ユーザー嗜好の保存
- 食べたい気分写真から推測する機能
- 近隣飲食店の提案

## 9. 技術的考慮事項

### 9.1 パフォーマンス
- 質問データのプリロード
- API呼び出しの最適化
- クライアントサイドキャッシング

### 9.2 セキュリティ
- GPT APIキーのセキュアな管理
- ユーザーデータの適切な保護

### 9.3 アクセシビリティ
- キーボード、マウス操作対応
- スクリーンリーダー対応
- 十分なコントラスト比の確保

---

この仕様書は、シンプルで使いやすい食事提案Webアプリケーションを開発するためのガイドラインです。React.jsとTypeScriptを使用し、ユーザーの食事選びをサポートする機能を提供します。